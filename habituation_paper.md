# Exploring Adaptive Agency III: Simulating the Evolution of Habituation and Sensitization

**Peter M. Todd**
todd@psych.stanford.edu

**Geoffrey F. Miller**
geoffrey@psych.stanford.edu

Department of Psychology
Stanford University
Jordan Hall Building 420
Stanford, California 94305 USA

## Abstract

Sensitization and habituation, we postulate, both serve the adaptive function of *cluster-tracking*: entraining and exploiting the basic spatio-temporal regularities in the environment. To better understand the adaptive pressures shaping cluster-tracking, we used a genetic algorithm to evolve simulated creatures controlled by neural networks. The creatures make decisions about when to eat in simple simulated environments containing 'food' (which raises fitness) and 'poison' (which lowers it) based on sensory cues. Food and poison were distributed in randomly-occurring clusters of a certain scale fixed for each environment. Sensory input had a limited accuracy level fixed for each environment. When sensory accuracy is moderate and food and poison come in fairly large clusters, certain time-delay feedback connections evolve to allow cluster-tracking. We ran several simulations for each of 6 cluster-scales and each of 7 levels of sensory accuracy. As expected, the average number of generations required to evolve cluster-tracking follows a U-shaped curve as a function of sensory accuracy, and generally declines as cluster scale increases. But an asymmetry in this ravine-like surface illuminates some previously unsuspected complexities of sensitization and habituation.

## 1 Sensitization and Habituation

Traditionally, sensitization and habituation have been viewed as low-level processes of behavioral adaptation classed together mostly due to their relative simplicity. Both 'merely' allow a creature's ongoing behavior to match and exploit current trends in the environment. Sensitization causes a generalized increase in neural excitability after presentation of a positive (or negative) stimulus, so that the creature is more likely to approach (or avoid) whatever stimulus it receives next. Habituation, on the other hand, is a more specific decrease in excitability and responsiveness after repeated encounters with a stimulus that proves unimportant. For example, an octopus will sensitize to the occurrence of food and tend thereafter to attack neutral objects placed before it, or if previously shocked will tend to shy away from the same neutral objects. A slug which withdraws its eye-stalks when first poked and prodded will habituate to the harmless stimuli and soon cease to respond to them.

The adaptive functions of sensitization and habituation can perhaps best be understood by viewing these processes as roughly symmetric and complementary means of adjusting behavior in a non-random world. As Wells (1968, p. 157) puts it, a creature "can improve its performance by taking advantage of the fact that, in the natural world, good and bad events do not occur at random. They clump. Predators hang around or go away, food is liable to come in batches." Wells goes on to discuss sensitization as a means of dealing with this 'clumpiness'; Hollis (1984) speaks similarly about habituation's function. We see both habituation and sensitization as fulfilling a more general adaptive function of entraining and exploiting statistical structure in the sequence of environmental cues — a function we call *cluster-tracking*.

In our ongoing study of *adaptive agency* (Miller & Todd, 1990, and Todd & Miller, 1990) — the generation of adaptive behavior in response to environmental challenges to individual fitness — we have found it fruitful to consider sensitization and habituation in this more general way as complementary mechanisms for generating adaptive behavior given certain spatial or temporal regularities in the environment. Given such regularities, sensitization can be viewed as a way for an organism to adaptively increase the probability of a specific response when it finds itself in an ongoing situation where that response is appropriate. Habituation, conversely, can be seen as a way to adaptively decrease the probability of a specific response in an ongoing situation where that response is inappropriate. The main utility of both processes depends on the fact that organisms may know the general pattern of regularities that characterize their world more accurately than they can perceive the specific current situation. They may use sensitization and habituation to generate adaptive sequences of behavior even when their ability to categorize the current environmental situation, and thus to decide the immediate appropriateness of each behavior in their repertoire, is compromised.

We have previously explored the interaction of the adaptive processes of associative learning and evolution by simulating the evolution of rudimentary neural-network based creatures that behave and learn in a simple environment (Todd & Miller, 1990). To investigate the proposed cluster-tracking adaptive functions of sensitization and habituation, we extended our previous study by adding certain temporal regularities to our simulated environments. We expected that the neural networks controlling the behavior of our simulated creatures would come to instantiate the kinds of sensitization and habituation appropriate to each environment. By studying the rates and results of this evolution in the different environmental situations, we hoped to better understand the nature and interactions of these adaptive processes.

## 2 Simulating Cluster-Tracking

Our current simulation method for studying adaptive agency uses a standard genetic algorithm to evolve neural network architectures controlling the behavior of simple simulated creatures in simulated environments. The environments contain 'food' (which raises fitness if eaten) and 'poison' (which lowers fitness if eaten), occurring in some spatio-temporal pattern. Both substances have certain perceivable features: in the current study, food always smells 'sweet' and poison always smells 'sour.' Thus, creatures whose networks adaptively indicate when to eat and when not to eat given the sensory cues they receive will typically evolve to dominate the population.

In this method, a strong genetic specification scheme (as defined by Miller, Todd, & Hegde, 1989) interprets each binary genotype as a *connectivity constraint matrix* which directly specifies the nature of each unit and connection in the network architecture. Once a network, instantiating the behavior-generating mechanisms of an individual creature, has been so constructed, it is evaluated in the simulated world over several time-steps representing the creature's lifespan. During each time-step, a creature encounters either food or poison. The creature's network then receives sensory input based on the cues available to it from the current substance (e.g. its smell), processes that input according to its architecture and current weights, generates behavior (e.g. eating) based on the activation of its output units, and changes its connection weights based on an unsupervised learning rule (e.g. Hebbian association). The effects of the creature's behavior on the world and on its own fitness are then registered, and the next time-step begins. After a fixed lifespan, the creature dies and its accumulated fitness determines the number of its offspring, according to a stochastic fitness-proportionate reproduction scheme with linear fitness-scaling. Two-point crossover and point mutation drive the genetic search process.

The creatures in the current study have 'nervous systems' consisting of just two units. One is a motor unit whose activity determines whether or not the creature eats the substance available at this time-step. The other unit can be one of several types in the creatures in the initial population (another motor unit, a processing 'hidden unit,' or a sensory input unit — see Todd & Miller, 1990), but in practice the evolving creatures rapidly converge on incorporating a smell-sensing input unit. In our simulated worlds, environmental noise limits the sensory accuracy of these units: in an environment allowing 75% accuracy, for example, creatures will generally mistake food for poison (and vice-versa) 25% of the time. Sensory units are linear, while motor units are logistic with activations from -1 to +1.

The creatures' networks can be fully interconnected, which with two units just means having a forward connection from the sensory unit to the motor unit, and a one-time-step-delay recurrent connection from the motor unit back to the sensory unit. In addition, each unit can have a one-time-step-delay recurrent connection back onto itself, and a bias. Each of the recurrent connections carries the activity of the sending unit at the previous time-step to the receiving unit. The connections and biases can all evolve a positive or negative (starting) weight of 16 different magnitudes (from 0.0 to 4.1). Furthermore, the genotype specifies which of the four connections and two biases are learnable (with Hebbian association).

In our previous studies of the evolution of associative learning, food and poison were distributed randomly in the environment. In such a higgledy-piggledy world, there was no spatio-temporal structure for sensitization or habituation to exploit. To set up adaptive pressures for the evolution of these cluster-tracking processes, we had to introduce 'clumpiness' in the distribution of food and poison in the environment. First, a random sequence of food and poison was generated as before, but now each occurrence of food or poison in this sequence was replaced by a run of N instances of food or poison to create an extended 'clump' in the final world-sequence. We call N the *clump-scale* parameter because it determines whether the clumpiness happens on a small or large scale. For example, if the original random sequence is "++...+..", and the clump-scale is 3, the sequence of food ("+") and poison (".") that this particular creature would encounter is "++++++.........+++......". The minimum (and modal) number of consecutive occurrences of the same substance (the smallest clump length) is N (here 3), the mean clump length is 2N, and the maximum may be very large (up to the number of time-steps in the creature's lifespan).

If sensory accuracy lies somewhere between 50% and 100%, so creatures receive some accurate information and some inaccurate, then an internal mechanism that can exploit whatever structure exists in the environment would prove adaptive. That is, if a creature could tell that it was in a food clump — e.g. that the past few things it encountered were food — then it might reasonably predict that the next substance encountered will also be food, and so should be eaten, even if environmental noise makes it smell like poison. It would 'sensitize.' Similarly, if the creature has been eating food for a while, but begins to smell more poison than food, it might predict that it is now in a poison-patch, and should abstain from eating for a while, again even if the next substance or two encountered appears to be food. It would 'habituate.' Thus, in worlds with clumpy structure that allow moderate sensory accuracy, both sensitization and habituation would prove adaptive, and we expect some mechanism enabling these processes to evolve.

Evolving a kind of rudimentary memory to do cluster-tracking might be the simplest means of instantiating sensitization and habituation in our simple creatures. Time-delay recurrent connections would allow units to accumulate and use positive or negative activation that indicates the nature of the current patch. For instance, a self-feedback connection of an appropriate weight on a sweet-smell sensory unit in a noisy environment would gradually accumulate more and more positive activation as it encounters more and more food in a food patch. After a few encounters, its activation would be high enough that even if the current input indicated a sour smell, the unit would still turn on as if it smelled something sweet, indicating food. Such a mechanism is likely to work best when feedback weights can be genetically specified with at least moderate precision, so we allowed 16 possible weight-magnitudes, in contrast with the 4 we used in previous studies.

## 3 Simulation Results

We explored the relationships between clump-scale, sensory accuracy, and time to evolve adaptive cluster-tracking. In initial simulations, we discovered that large clump-scales were important for the evolution of the creatures' sensitization and habituation, so we used clump-scale values of 1, 5, 10, 20, 40, and 80. We fixed the creature lifespan at 1000 timesteps, and ran each of the clump-scales in worlds with smell-sense accuracies of 55%, 60%, 70%, 75%, 80%, 90%, and 95%, yielding a 6x7 table of environments. In each of these 42 environments, we evolved at least 5 populations (10 for 75% of the cases) of 100 creatures until the average population fitness passed a threshold indicating that adaptive cluster-tracking had evolved. If this threshold had not been reached by 2000 generations, we stopped the simulation at this point. Finally, we used the average number of generations taken to pass the threshold (or 2000 generations for those populations that did not exceed the threshold) as our measure of the time taken to evolve cluster-tracking in each environment.

We expected to see two trends. First, for a given clump-scale, we expected the time to evolve cluster-tracking to follow a U-shaped curve with respect to sensory accuracy, just as we discovered with the evolution of simple associative learning in our previous studies (Todd & Miller, 1990). This U-shaped relation can be understood through a simple thought-experiment. In the limiting case of 50% (chance) accuracy, no veridical information is available for either adaptive moment-to-moment behavior or for adaptive cluster-tracking, so time to evolve cluster-tracking will be effectively infinite. In the opposite limiting case of 100% (perfect) accuracy, a fixed connection of the proper valence between the sensory unit and motor unit suffices for perfectly adapted behavior, so there is no adaptive pressure for cluster-tracking to evolve and, again, time to evolve it will be effectively infinite. But for moderate sensory accuracies, cluster-tracking is both easy to use and advantageous to evolve, resulting in fast evolution times.

The second trend we expected was that, for a given fixed sensory accuracy, larger clump-scales should allow faster evolution of cluster-tracking. Longer clumps yield a higher ratio of clump-exploitation-time (benefit) to clump-entrainment-time (cost), and so will make cluster-tracking relatively more advantageous and increase the adaptive pressure to evolve this ability. That is, with longer clumps, creatures can spend more time in a clump, using their built-up evidence about the nature of that clump to overcome environmental noise, and less time switching between clumps, which always results in some behavioral errors before sufficient evidence has been accumulated. In the limiting case of clump-scale 1, there is no environmental regularity for cluster-tracking to exploit, so again time to evolve cluster-tracking should be effectively infinite.

What we actually found was the family of curves shown in Figure 1. For each given clump-scale, there is indeed a U-shaped evolution curve, and for the high accuracies at least, time to evolve cluster-tracking goes down as clump-scale increases. But there is an interesting interaction that we did not expect, between high clump-scales and low sensory accuracies, which results in the long evolution times seen in the front left quadrant of the surface. This rise in turn creates the diagonal 'ravine' of lowest evolution times running from left rear to front right in the figure, rather than symmetrically down the middle of the figure as expected.

We believe that this apparent anomaly results from using the same fixed lifespan for all environments. Smaller clump-scales insure that each creature experiences a large 'sample size' of food and poison clumps. By the Law of Large Numbers, the variance between creatures in the ratio of food to poison encountered will be small. By contrast, larger clump-scales yield higher variance between creatures for this ratio, so add a kind of noise to the evolutionary process. Creatures with bad network designs, such as those biased to eat at every time-step, might still do very well in such worlds, e.g. if they are born into one that happens to contain more large food-clumps than poison-clumps. These erroneous designs may spread through the population, and it could take longer for natural selection to distinguish them from the ultimately more adaptive cluster-trackers. But in small-clump-scale worlds, these creatures would encounter roughly equal proportions of food and poison, and so would never be able to do very well. Evolution would quickly eliminate them and select for adaptive cluster-tracking.

We investigated this hypothesis by evolving 10 populations in a world with clump-scale 80 and 70% smell-sense accuracy, but increasing lifespan from 1000 time-steps to 4000. With this change, average time to evolve cluster-tracking does indeed decrease significantly, from 187 to 52 generations. This suggests that if we hold the ratio of clump-scale to lifespan constant, the rise in the front left quadrant of Figure 1 would disappear. Further, these creatures encounter as many clumps as the original 1000-step-lifespan creatures did in worlds with clump-scale 20, who took longer on average (61 generations) to evolve cluster-tracking. Thus, controlling for number of clumps encountered, evolution time seems to decrease as clump-scale increases, as we postulated.

This is not to say, though, that we *should* hold the ratio of clump-scale to lifespan constant. Real creatures in real environments do not generally have the luxury of adjusting their lifespan to the size of food-patches they are likely to encounter. When lifespans are limited, our finding that large clump-scales can actually slow down the evolution of cluster-tracking may be more relevant to natural situations.

Our next step for studying the evolution of cluster-tracking is to categorize and analyze the actual network architectures found in each population. To this end, we are developing methods of determining the "average creature" in a population and following its behavior throughout its lifespan. We hope in this way to gain a better understanding of the network dynamics that evolve to track environment dynamics, and the ways in which structure in the world can be entrained and exploited by the evolved mechanisms of adaptive agency.

## References

Hollis, K.L. (1984). Cause and function of animal learning processes. In P. Marler and H.S. Terrace, eds. *The biology of learning*. New York: Springer-Verlag.

Miller, G.F., and Todd, P.M. (1990). Exploring adaptive agency I: Theory and methods for simulating the evolution of learning. In D.S. Touretzky, J.L. Elman, T.J. Sejnowski, and G.E. Hinton, eds. *Proceedings of the 1990 Connectionist Models Summer School* (pp. 65-80). San Mateo, CA: Morgan Kaufmann.

Miller, G.F., Todd, P.M., and Hegde, S.U. (1989). Designing neural networks using genetic algorithms. In J.D. Schaffer, ed. *Proceedings of the Third International Conference on Genetic Algorithms* (pp. 379-384). San Mateo, CA: Morgan Kaufmann.

Todd, P.M., and Miller, G.F. (1990). Exploring adaptive agency II: Simulating the evolution of associative learning. In S. Wilson and J.-A. Meyer, eds. *Proceedings of the International Conference on Simulation of Adaptive Behavior: From Animals to Animats*. Cambridge, MA: MIT Press/Bradford Books.

Wells, M. (1968). *Lower animals*. New York: McGraw-Hill.

---

**Figure 1.** Simulation results illustrating the effect of adaptive pressures controlled by the clump-scale and sensory accuracy parameters on time to evolve adaptive cluster-tracking. Vertical height represents time required to evolve cluster-tracking, ranging from 0 to 2000 generations. The horizontal axis represents sensory accuracy, ranging from 50% (on the left) to 100% (on the right), in increments of 5%. The depth axis represents clump-scale, ranging from 1 (at the back) to 80 (at the front). The surface shown was linearly interpolated from the average evolution times for the 5 or 10 runs completed for each of 6 accuracy levels (55%, 60%, 70%, 75%, 80%, 90%, and 95%) and 7 clump scales (1, 5, 10, 20, 40, and 80).
